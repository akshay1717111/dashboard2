<!DOCTYPE html>
<html lang="en">
<head>
  <style>
    li:hover{
      background-color:lightseagreen;
   }
   .error{
  display: none;
  margin-left: 10px;
}   
.error_show{
  color: red;
  margin-left: 10px;
}
@keyframes move{
0%{
 transform: scale(1) rotate(90deg);
}
  100%{
   transform: scale(2) rotate(0.1deg);

  }
}
#jobs{
  font-size: 15px;
}
</style>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/css-element-queries/1.1.1/ElementQueries.js">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <link rel="apple-touch-icon" sizes="76x76" href="../static/assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../static/assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
     Dashboard
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="../static/assets/css/material-dashboard.css?v=2.1.1" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="../static/assets/demo/demo.css" rel="stylesheet" />
</head>
<body>
  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../static/assets/img/sidebar-1.jpg">
      <!--
        Tip 1: You can change the color of the sidebar using: data-color="purple | azure | green | orange | danger"

        Tip 2: you can also add an image using data-image tag
    -->
      <div class="logo">
        <a href="http://www.tekfriday.com" class="simple-text logo-normal">
          Tekfriday
        </a>
      </div>
      <div class="sidebar-wrapper">
          <ul class="nav" id="jobs">
              <li class="nav-item ">
                  <div class="nav-link" style="color: black; margin: 0px 15px; cursor: pointer;" onclick="get_data()">
                     Dashboard
                    </div>
                </li>
                <li class="nav-item">
                    <div class="nav-link" style=" color: black; margin: 0px 15px; cursor: pointer;" onclick="runvalidations()">
                      Run valiations
                    </div>
               </li>
           </ul>
        </div>
    </div>
    <div class="main-panel" id="mainpanel" style="background-color:lightyellow">
    
      </div>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="../static/assets/js/core/jquery.min.js"></script>
  <script src="../static/assets/js/core/popper.min.js"></script>
  <script src="../static/assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../static/assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="../static/assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="../static/assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="../static/assets/js/plugins/jquery.validate.min.js"></script>
  <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
  <script src="../static/assets/js/plugins/jquery.bootstrap-wizard.js"></script>
  <!--  Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
  <script src="../static/assets/js/plugins/bootstrap-selectpicker.js"></script>
  <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
  <script src="../static/assets/js/plugins/bootstrap-datetimepicker.min.js"></script>
  <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
  <script src="../static/assets/js/plugins/jquery.dataTables.min.js"></script>
  <!--  Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
  <script src="../static/assets/js/plugins/bootstrap-tagsinput.js"></script>
  <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
  <script src="../static/assets/js/plugins/jasny-bootstrap.min.js"></script>
  <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
  <script src="../static/assets/js/plugins/fullcalendar.min.js"></script>
  <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
  <script src="../static/assets/js/plugins/jquery-jvectormap.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="../static/assets/js/plugins/nouislider.min.js"></script>
  <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
  <!-- Library for adding dinamically elements -->
  <script src="../static/assets/js/plugins/arrive.min.js"></script>
  <!--  Google Maps Plugin    -->
  <!--<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>-->
  <!-- Chartist JS -->
  <script src="../static/assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="../static/assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../static/assets/js/material-dashboard.js?v=2.1.1" type="text/javascript"></script>
  <!-- Material Dashboard DEMO methods, don't include it in your project! -->
  <script src="../static/assets/demo/demo.js"></script>
  <script>
     $("[name='name_x']").prop("required", true);
   // validate();
   // $('#mainTaskName, #inputEmail, #inputTel').change(validate);
    get_data();
    function mail(){
       var aksh=[];
       for(var i=1;i<10;i++){
         if(document.getElementById('remember('+i+')').checked==true){
           var g1=document.getElementById('mainjob('+i+')').value;
           aksh.push(g1);
           alert(g1);
         }
         else{
           debugger;
          aksh.push(i);
         }
       }
       akshay=aksh.toString();
        var getEmail = document.getElementById('send').value;
        $.ajax({
                    url: "http://localhost:5007/home_sub",
                        method: "POST",
                        data:{ SubJobNames: akshay,JobName:""},//posting jobname to email id
                        dataType: "json"
                    });
        }
    function formsubmission(){
        var maintask=document.getElementById("maintaskid").value;
        var subtask=document.getElementById("subtaskid").value;
        var scheduledtime=document.getElementById("scheduledtimeid").value;
        var scheduledday=document.getElementById("scheduleddayid").value;
        var sqlquery=document.getElementById("sqlqueryid").value;
        console.log(maintask+","+subtask);
    }
      function runvalidations(){
           document.getElementById("mainpanel").innerHTML='<h2 class="text-center">Run Validations</h2><div class="content"> <div class="container-fluid"> <div class="row"> <div class="container"> <div class="form-group"> <h4>Taskname</h4> <select class="form-control" id="op1" style="max-width: 40%; margin-bottom: 20px;padding: 10px;"> <option selected="selected">select here</option></select> </div> <div class="form-group"> <label for="Starttime">StartTime:</label> <input type="datetime-local" class="form-control" id="start" name="start" style="max-width: 40%; margin-bottom: 20px;"> </div> <div class="form-group input-lg"> <label for="Endtime">EndTime:</label> <input type="datetime-local" class="form-control" id="end" name="end" style="max-width: 40%;"> </div> <button class="btn btn-info btn-sm" onclick="error_table()" style="top:25%">View Errors</button> </div> <div id="tabledisplaying" style="width:100%;"></div> <div class="row" id="dynamicrow"> </div> </div> </div> </div> <footer class="footer" style="bottom: 0"> <div class="container-fluid"> <nav class="float-left"> <ul> <li> <a href="http://www.tekfriday.com/"> Tekfriday </a> </li> <li> <a href="http://www.tekfriday.com/"> About Us </a> </li> <li> <a href="http://www.tekfriday.com/ContactUs.html"> Blog </a> </li> <li> <a href="http://www.tekfriday.com/Company.html"> Licenses </a> </li> </ul> </nav> <div class="copyright float-right"> Â© </div> </footer>';
           $.ajax({
                url: "http://localhost:5007/home_main",
                datatype: "JSON",
                type: "GET",
                success: function (data) {
                        var r_data=data;
                 for(i in data)
                    {
                        var opt = data[i].Main_jobs;
                        $("#op1").append("<option>"+opt+"</option>");
                    }
                console.log(data)
                }
            });
      } 
             function get_data(){     
                $.ajax({
                    url: "http://localhost:5007/home_main",
                        method: "GET",
                        dataType: "json"
                    }).done(function( data ) {
                        var r_data=data;
                        sidebargenfunction(r_data);
                        cardgenfunction(r_data);
                       // setTimeout(get_data, 2000); 
                        console.log(r_data) 
                        }).fail(function(error) {
                        alert("Error")
                });  
        }
     function sidebargenfunction(data){
          document.getElementById("jobs").innerHTML='<li class="nav-item "> <div class="nav-link" style="margin: 0px 15px; cursor: pointer;" onclick="get_data()"> Dashboard </div> </li> <li class="nav-item"> <div class="nav-link" style="margin: 0px 15px; cursor: pointer;" onclick="runvalidations()"> Run valiations </div> </li>';
           for(i in data) {
             document.getElementById("jobs").innerHTML+='<a href="nachavalidation.html"><li class="nav-item "> <div class="nav-link subtask" style="color: black; margin: 0px 10px; cursor: pointer;" value='+data[i].Main_jobs+'>'+data[i].Main_jobs+'</div> </li></a>';
               }
            } 
    //send jobname,start and endtimes to display table 
    function error_table(){
      var a='<table class="table" width="100%" id="table"> <thead id="thead"> <tr> <th>TaskName</th> <th>Date</th> <th>ErrorStatus</th> </tr> </thead> <tbody id="tablebody"></tbody> </table>';
      document.getElementById('tabledisplaying').innerHTML=a;
      //displaying tasknames containing errors
     /* for(i in r_data){
                      document.getElementById("tablebody").innerHTML += "<tr><td>"+r_data[i].TaskName+"</td><td>"+r_data[i].Date+"</td><td>"+r_data[i].IsError+"</td></tr>";
           } */
         for(var k=0;k<10;k++){
          document.getElementById("tablebody").innerHTML += "<tr><td>"+k+"</td><td>"+k+80+"</td><td>"+k*10+"</td></tr>";
         }  
      }     
    function cardgenfunction(r_data){
      var date=new Date().getFullYear();
       document.getElementById("mainpanel").innerHTML='<nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top "><div class="text-center"> <button class="btn btn-info pull-right mb-4" style="margin-left: 29px; margin-top: 14px;" data-toggle="modal" data-target="#modalLoginForm">+ADD JOBS</button> </div><div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header text-center"> <strong class="modal-title w-100 font-weight-bolder">ADD MAINTASK</strong> <button type="button" class="close closeModal"  data-dismiss="modal">&times;</button> </div> <div class="modal-body mx-5"> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="defaultForm-email">Main Task</label> <input type="text" name="name_x" id="mainTaskName" class="form-control validate" maxlength="25" required/><span class="error" id="errormain">This field is required</span> </div>  <div class="modal-footer d-flex justify-content-center"  style="border:0px;"> <input type="submit" class="btn btn-success submit" data-dismiss="modal" onclick="formsubmission()" id="submitbutton"> </div> </div></div> </div></div> <div class="collapse navbar-collapse justify-content-end"> <ul class="navbar-nav"> <li class="nav-item dropdown"><a class="nav-link" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">person</i><p class="d-lg-none d-md-block">Account</p></a><div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile"><a class="dropdown-item" href="#">Profile</a><a class="dropdown-item" href="#">Settings</a><div class="dropdown-divider"></div><a class="dropdown-item" href="../Login_v1-20181025T140518Z-001/Login_v1/index.html">Log out</a></div></li></ul> </div> </div> </nav> <!-- End Navbar --> <div class="content"> <div class="container-fluid"> <div class="row" id="dynamicrow"> </div></div> </div> <footer class="footer" style="bottom: 0"> <div class="container-fluid"> <nav class="float-left"> <ul> <li> <a href="http://www.tekfriday.com/"> Tekfriday </a> </li> <li> <a href="http://www.tekfriday.com/"> About Us </a> </li> <li> <a href="http://www.tekfriday.com/ContactUs.html"> Blog </a> </li> <li> <a href="http://www.tekfriday.com/Company.html"> Licenses </a> </li> </ul> </nav> <div class="copyright float-right"> Â© '+date+' made with <i class="material-icons">favorite</i> by <a href="hhttp://www.tekfriday.com/Company.html" target="_blank">Tekfriday</a> for a better web. </div> </div> </footer> </div>';
        document.getElementById('dynamicrow').innerHTML="";
        for(i in r_data){
        document.getElementById('dynamicrow').innerHTML+='<div class="col-lg-4 col-md-6 col-sm-6"><div class="card card-stats"><div class="card-header card-header-warning card-header-icon"><div class="card-icon" style="padding:0"><i class="material-icons" style="background: green;">info_outline</i></div><p class="card-category" style="font-size:13px;font-weight:bold;">'+r_data[i].Main_jobs+'</p><h3 class="card-title">'+r_data[i].errors+'</h3></div><div class="card-footer"><button class="btn btn-info btn-sm subtask ml-auto" onclick="subjobrequest()" id="mainjob('+i+')"  value='+r_data[i].Main_jobs+'>View Subtasks</button></div></div></div>  <div class="fixed-bottom"><button type="button" onclick="scrollSmoothToBottom()" class="btn btn-info btn-round btn-md bg-none pull-right w-5" style="bottom: 305px;" ><i class="fa fa-chevron-circle-down" aria-hidden="true" style="font-size:3em;"></i></button></div>';
       }
     }
     function subjobcardgenfunction(r_data){
      document.getElementById("mainpanel").style.WebkitAnimation="move 0.5s 1";
      document.getElementById("mainpanel").style.animation="move 0.5s 1";
      var date=new Date().getFullYear();
       document.getElementById("mainpanel").innerHTML='<nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top "><div class="text-center"> <button class="btn btn-info btn-rounded mb-4" style="margin-left: 29px; margin-top: 14px;n" data-toggle="modal" data-target="#modalLoginForm">+ADD JOBS</button> </div> <h2 class="font-weight-bold float-lg-center float-sm-right" style="margin-left: 293px;">Sub Tasks</h2><div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header text-center"> <strong class="modal-title w-100 font-weight-bolder">ADD</strong> <button type="button" class="close closeModal"  data-dismiss="modal">&times;</button></div> <div class="modal-body mx-5"> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="defaultForm-email">Main Task</label> <input type="text" id="maintaskid" class="form-control validate" maxlength="25" required/><span class="error" id="errormain">This field is required</span> </div> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="defaultForm-pass">Sub Task</label> <input type="text" id="subtaskid" class="form-control validate"> </div> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="subtaskid">SQL Query</label> <input type="text" id="sqlqueryid" class="form-control validate"> </div> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="sqlqueryid">Scheduled Time</label> <input type="datetime-local" id="scheduledtimeid" class="form-control validate"> </div> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" for="scheduledtimeid">Scheduled Day</label> <input type="text" id="scheduleddayid" class="form-control validate"> </div> <div class="modal-footer d-flex justify-content-center"  style="border:0px;"> <button class="btn btn-success submit" data-dismiss="modal" onclick="formsubmission()">SUBMIT</button></div> </div> </div> </div> </div><div class="collapse navbar-collapse justify-content-end"> <ul class="navbar-nav"> <li class="nav-item dropdown"> <a class="nav-link" href="#pablo" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="material-icons">person</i> <p class="d-lg-none d-md-block"> Account </p> </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile"> <a class="dropdown-item" href="#">Profile</a> <a class="dropdown-item" href="#">Settings</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="./login.html">Log out</a> </div> </li> </ul> </div> </div> </nav> <!-- End Navbar --> <div class="content"> <div class="container-fluid"> <div class="row" id="dynamicrow"> </div><div class="modal fade" id="modalmail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header text-center"> <strong class="modal-title w-100 font-weight-bolder"><strong>STATUS</strong> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">Ã</span> </button> </div> <div class="modal-body mx-5"> <div class="md-form mb-2"> <label data-error="wrong" data-success="right" data-validate = "Valid email is required: ex@tekfriday.com" for="defaultForm-email" oninvalid="if (this.value == ""){this.setCustomValidity("This field is required!")} if (this.value != "@tekfriday.com"){this.setCustomValidity("The email you entered is invalid!")}" oninput="setCustomValidity("enter @tekfriday.com")"><strong>Email:</strong></label> <input type="email" pattern=".+@tekfriday.com" id="send" class="form-control validate" placeholder="abc@tekfriday.com"> </div> <div class="modal-footer d-flex justify-content-center"> <button class="btn btn-success closeModal" onclick="mail()" data-dismiss="modal">Send</button> </div> </div> </div> </div> </div><div class="fixed-bottom"><button type="button" class="btn btn-info btn-round btn-lg bg-none pull-right w-5" style="bottom: 238px;" data-toggle="modal" data-target="#modalmail"><span style="font-size: 15px;"><i class="fa fa-commenting-o fa-lg" aria-hidden="true" style="font-size:3em;"></i></span></button></div></div> <footer class="footer" style="bottom: 0"> <div class="container-fluid"> <nav class="float-left"> <ul> <li> <a href="http://www.tekfriday.com/"> Tekfriday </a> </li> <li> <a href="http://www.tekfriday.com/"> About Us </a> </li> <li> <a href="http://www.tekfriday.com/ContactUs.html"> Blog </a> </li> <li> <a href="http://www.tekfriday.com/Company.html"> Licenses </a> </li> </ul> </nav> <div class="copyright float-right"> Â© '+date+' made with <i class="material-icons">favorite</i> by <a href="hhttp://www.tekfriday.com/Company.html" target="_blank">Tekfriday</a> for a better web. </div> </div> </footer> </div>';
        document.getElementById('dynamicrow').innerHTML="";
        for(i in r_data){
        document.getElementById('dynamicrow').innerHTML+='<div class="col-lg-4 col-md-6 col-sm-6"><div class="card card-stats"><div class="card-header card-header-warning card-header-icon"><div class="card-icon" style="padding:0"><i class="material-icons" style="background:orange;">info_outline</i></div><p class="card-category" style="font-size:13px;font-weight:bold;">'+r_data[i].subjob+'</p><h3 class="card-title">'+r_data[i].errors+'</h3><strong class="card-title" style="color: #949494;"><i class="fa fa-clock-o" style="font-size: 35 px;"  aria-hidden="true"></i>'+r_data[i].Status+'</strong></div><div class="card-footer"><input type="checkbox" id="remember('+i+')" style=" width: 25px;height: 25px; margin-top: auto;"><button class="btn btn-info btn-sm subtask ml-auto" onclick="tabledispaly()" id="mainjob('+i+')"  value='+r_data[i].subjob+'>View Errors</button></div></div></div>';
       }
     }
     //$(document).ready(function (){
    function validate(){
    if ($('#mainTaskName').val().length   >   0  
    /* &&
        $('#inputEmail').val().length  >   0   &&
        $('#inputTel').val().length    >   0 */) {
        $("#input").prop("required", true);
    }
    else {
        $("#submitbutton").prop("disabled", true);
    }
}
    function subjobrequest(){
      var mainjob=document.getElementById("mainjob("+i+")").value;
      var data; $.ajax({
                    url: "http://ab76f987.ngrok.io/home_sub",
                        method: "POST",
                        data:JSON.stringify({ JobName: mainjob ,SubJobNames: ""}),//posting jobname to url
                        dataType: "json",
                        contentType: 'application/json'
                    }).done(function( data ) {
                        var r_data=data;
                        subjobcardgenfunction(r_data);
                        alert("r_data"); 
                        }).fail(function(error) {
                        alert("Error")
                });

    }
     $(document).ready(function(){
        $('body').on('click', '.submit', function(){
                 var x =document.getElementById("maintaskid").value;
                 if(x==""){
                   }
                console.log(x)
              })   
        $('body').on('click', '.openmodal', function(){
          $('#myModal').modal('show');
        })         

        $('body').on('click','.closeModal', function(){
          $('.modal-backdrop').hide();
        })
    })
  </script>
  <script>
    
    scrollingElement = (document.scrollingElement || document.body)
function scrollSmoothToBottom () {
   $(scrollingElement).animate({
      scrollTop: document.body.scrollHeight
   }, 1000);
}
    $(document).ready(function() {
      // Javascript method's body can be found in assets/js/demos.js
      md.initDashboardPageCharts();
});
  </script>
</body>
</html>